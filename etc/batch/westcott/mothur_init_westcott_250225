# source
# https://mothur.org/wiki/batch_mode/

##################
##### Names and labels
# Project folders
proj_wd=/home/gyula/bfx_sources/tmp/MOTHUT_dev/pipeline_westcott

# res_out=$proj_wd/res_out
log_out=$proj_wd/log_out

logname=250225_westcott_project

set.logfile(name=$log_out/$logname)

# Project name
proj_name=westcott_MothurBatchProject
#logfile name for this analysis


# fq_in=$proj_wd/fq_mini
fq_in=/home/gyula/bfx_sources/Example_dataset/16S_V4_DADA2_Pipeline_Tutorial_ILMN/MiSeq_SOP_PRIMER-TRIMMED/fq_mini

# oligos=$proj_wd/oligos.txt

# Numeric variables
# screen.seq length limits
minl=200
# screen.seq length limits
maxl=275
# pre.cluster diff
preCdiff=2
#set type of data fastq or gz
fqtype=gz

# contaminents to remove from data in remove.linage
contaminants=Chloroplast-Mitochondria-unknown-Archaea-Eukaryota

#set number of processors to use during analysis
proc=8

# Reference source
# https://mothur.org/wiki/silva_reference_files/

# Set location of lab reference files
# REFERENCE_LOCATION=/Users/sarahwestcott/Desktop/release
reference_dir=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR

# ARB extracts
# Full-length sequences and taxonomy references (145520 bacteria, 3744 archaea, and 15032 eukarya sequences).
# Release 138.2
# reference for alignment
#references for classification
# alignref_full=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.nr_v138_2.align
silva.nr_v138_2.align=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.nr_v138_2.align
# alignref_full_seed=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.align
silva.seed_v138_2.align_seed=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.align
# taxonref_full=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.nr_v138_2.tax
silva.nr_v138_2.tax=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.nr_v138_2.tax
# taxonref_full_seed=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.tax
silva.seed_v138_2.tax=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.tax

# Separate reference datasets
# Release V102
# reference for alignment
alignref_sep=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Separate/V102/silva.bacteria/silva.bacteria.fasta
taxonref_sep=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Separate/V102/silva.bacteria/silva.bacteria.silva.tax

pcr.seqs(fasta=$alignref_sep, outputdir=$reference_dir/Separate/V102/silva.bacteria, start=11894, end=25319, keepdots=F)
rename.file(fasta=current, new=$reference_dir/Separate/V102/silva.bacteria/silva.bacteria.v4.fasta)
silva.bacteria.v4.fasta=$reference_dir/Separate/V102/silva.bacteria/silva.bacteria.v4.fasta

# RDP reference files
trainset19_072023.rdp.fasta=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/RDP_ref_files/V19/trainset19_072023.rdp/trainset19_072023.rdp.fasta
trainset19_072023.rdp.tax=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/RDP_ref_files/V19/trainset19_072023.rdp/trainset19_072023.rdp.tax
trainset19_072023.pds.fasta=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/RDP_ref_files/V19/trainset19_072023.pds/trainset19_072023.pds.fasta
trainset19_072023.pds.tax=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/RDP_ref_files/V19/trainset19_072023.pds/trainset19_072023.pds.tax

# final ref parameter
# alignref=$alignref_sep
# taxonref=$taxonref_sep

# Experimental specific variables
mouse.time.design=/home/gyula/bfx_sources/Example_dataset/16S_V4_DADA2_Pipeline_Tutorial_ILMN/MiSeq_SOP/mouse.time.design
mouse.dpw.design=/home/gyula/bfx_sources/Example_dataset/16S_V4_DADA2_Pipeline_Tutorial_ILMN/MiSeq_SOP/mouse.dpw.design


#run generic Standard Operating Procedure for analysis in the Schloss Lab
./mothur_pipeline_westcott.batch
