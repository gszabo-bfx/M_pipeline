# source
# https://mothur.org/wiki/batch_mode/

##################
##### Names and labels
# MOTHUR Project working folder folders
proj_wd=/home/gyula/bfx_sources/tmp/MOTHUT_dev/pipeline_MATE_MiSeq_SOP
out_dir=$proj_wd/res_out
log_out=$proj_wd/log_out

# Project name
# Prefix for the output files
proj_name=MATE_MiSeq_SOP_MothurBatchProject

#logfile name for this analysis
log_name=MATE_16SV3V4_project

# set logfile location
set.logfile(name=$log_out/$log_name)
# set.logfile(name=/home/gyula/bfx_sources/tmp/MOTHUT_dev/pipeline_MATE_MiSeq_SOP/log_out/MATE_16SV3V4_project)

# fq_in=$proj_wd/fq_mini
fq_in=/home/gyula/bfx_sources/MATE/BakaE/MOTHUR_test/fq_mini
# oligos=$proj_wd/oligos.txt

#set number of processors to use during analysis
proc=8

# Variables for MOTHUR functions
#set type of data fastq or gz
fqtype=gz

# screen.seq 01 after make.contigs
screen_seq_01_minl=400
screen_seq_01_maxl=500
screen_seq_01_maxamb=0
screen_seq_01_maxhomop=8

# screen.seq 02 after align.seq
screen_seq_02_start=1
screen_seq_02_end=18929

# pcr.seq start end positions
# 16S ILMN 314F-805R WITH PRIMERS
# 6388 25316
# 16S ILMN 314F-805R WITHOUT PRIMERS
# 6426    23443
pcr_seq_start=6388    
pcr_seq_end=25316

# pre.cluster diff
preCdiff=2
# contaminents to remove from data in remove.linage
contaminants=Chloroplast-Mitochondria-unknown-Archaea-Eukaryota


# Reference source
# https://mothur.org/wiki/silva_reference_files/

# Set location of lab reference files
# REFERENCE_LOCATION=/Users/sarahwestcott/Desktop/release
reference_dir=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR

##################
# MOTHUR REFRENCE FILES
# https://mothur.org/wiki/silva_reference_files/



##################
# PRIMARY ALIGNMENT 

# ARB extracts
# Full-length sequences and taxonomy references (145520 bacteria, 3744 archaea, and 15032 eukarya sequences).
# Release 138.2
# reference for alignment
# references for classification
#
# 145520 bacteria, 3744 archaea, and 15032 eukarya sequences
silva.nr_v138_2.align=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.nr_v138_2.align
silva.nr_v138_2.tax=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.nr_v138_2.tax
# 6727 bacteria, 133 archaea, and 1847 eukarya sequences
silva.seed_v138_2.align_seed=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.align
silva.seed_v138_2.align_seed_V3V4=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.pcr.align
silva.seed_v138_2.tax=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.tax

# Separate reference datasets
# https://mothur.org/wiki/silva_reference_files/
# Release V102
# reference for alignment
# bacterial references (14,956 sequences)
# archaeal references (2,297 sequences)
# eukaryotic references (1,238 sequences)
# Silva-based alignment of template file for chimera.slayer (5,181 sequences)
#
alignref_sep_bac=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Separate/V102/silva.bacteria/silva.bacteria.fasta
taxonref_sep_bac=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Separate/V102/silva.bacteria/silva.bacteria.silva.tax

# RDP reference files
# https://mothur.org/wiki/rdp_reference_files/
# V19
# RDP 23,853 bacterial, 788 archaeal, and 1 eukaryotic SSU rRNA gene sequences
# taxonomies only go to the genus level
trainset19_072023.rdp.fasta=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/RDP_ref_files/V19/trainset19_072023.rdp/trainset19_072023.rdp.fasta
trainset19_072023.rdp.tax=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/RDP_ref_files/V19/trainset19_072023.rdp/trainset19_072023.rdp.tax
# PDS = RDP + reference with 119 mitochondrial 16S rRNA gene sequences added as members of the Rickettsiales and four 18S rRNA gene sequences added as members of the Eukarya
trainset19_072023.pds.fasta=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/RDP_ref_files/V19/trainset19_072023.pds/trainset19_072023.pds.fasta
trainset19_072023.pds.tax=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/RDP_ref_files/V19/trainset19_072023.pds/trainset19_072023.pds.tax


###########################
# REFERENCES USED IN SCRIPT
alignref=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.align
# replace alignref suffix with "pcr.align"
trimmed_alignref=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.pcr.align
taxonref=/home/gyula/bfx_sources/RefSeqs/Amplicon/Silva/16S/MOTHUR/Full/V138.2/silva.seed_v138_2.tax





#run generic Standard Operating Procedure
./mothur_pipeline_MATE_MiSeq_SOP_current.batch
